<!DOCTYPE html>
<html>
	<head lang="ru">
		<title>Whitesquare</title>
		<meta name="viewport" content="width=device-width, initial-scale=1"> 
		<link href="../public/bootstrap-3.3.6-dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"> 
		
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
		<![endif]-->
		
	</head>
	<body>
		<div class="container">
			<header>
				<a href="/"><img src="" alt="Whitesquare logo"></a>
			</header>
			<nav class="navbar navbar-default">
				<div class="container-fluid">
					<!-- Brand and toggle get grouped for better mobile display -->
					<div class="navbar-header">
					  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					  </button>
					  <a class="navbar-brand" href="#">Brand</a>
					</div>
					
					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
						<ul class="nav navbar-nav">
							<li><a href="C:\wamp64\www\stat.admin\client\index.html">Главная</a></li>
							<li><a href="/news/">Новости</a></li>
							<li class="active"><a href="C:\wamp64\www\stat.admin\client\expensetypelist.html">Общая статистика</a></li>
							<li><a href="/about/">О проекте</a></li>			
							<li><a href="/help/">Обращение в службу поддержки</a></li>
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li><button type="button" class="btn btn-default navbar-btn" data-toggle="modal" data-target="#logonModal">Вход</button></li>
							<li><button type="button" class="btn btn-default navbar-btn" data-toggle="modal" data-target="#registerModal">Регистрация</button></li>
						</ul>
					</div><!-- /.navbar-collapse -->
				</div><!-- /.container-fluid -->
			</nav>
			
			<!-- Chart -->
			<div class="row">
				<div class="col-lg-12" >
					<div class="panel panel-default" id="scroller_organizationlist_266570221142355520">
						<div class="panel-heading stat-scroller-header">
							&nbsp;Расходы "Ремонт дороги"
						</div><!-- /.panel-heading -->
						<!--<div class="panel-body">-->
							<input hidden="" id="page" value="1">
							<input hidden="" id="sort" value="id">
							<input hidden="" id="order" value="DESC">
							<input hidden="" id="page_size" value="100">
							
							<table class="table table-striped table-bordered table-hover table-responsive">
								<thead>
									<!-- строка заголовков -->
									<tr>
										<th>
											<span onclick="change_sort('scroller_organizationlist_266570221142355520', 'id');"><u>Регион</u></span>
											<button type="button" class="btn btn-default btn-xs" aria-label="ID" name="id">
												<span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span>
											</button>
										</th>
										<th>
											<span onclick="change_sort('scroller_organizationlist_266570221142355520', 'name');"><u>Наименование расхода</u></span>
										</th>
										<th>
											<span onclick="change_sort('scroller_organizationlist_266570221142355520', 'name');"><u>Муниципалитет</u></span>
										</th>
										<th  style="width: 120px;">
											<span onclick="change_sort('scroller_organizationlist_266570221142355520', 'amount');"><u>Сумма, р.</u></span>
										</th>
										<th>Контакты</th>
										<th>Действия</th>
									</tr>
								</thead>
								<tbody>
									<!-- строка фильтров -->
									<!--<tr>
										<td class="stat-row-checkbox-td"></td>
											<td class="stat-id-td">
												<input type="number" name="filter_id" value="" class="stat-id-input-field inited" min="0">
											</td>
											<td class="">
												<input type="text" name="filter_name" value="" class="inited">
											</td>
											<td class="">
												<select name="filter_region_id">
													<option value="*" selected="selected"></option>
													<option value="20">Москва</option>
													<option value="21">Питер</option>
													<option value="22">Московска область</option>
												</select>
											</td>
											<td class="">
												<input type="text" name="filter_contacts" value="" class="inited">
											</td>
											<td class="">
												<input type="email" name="filter_email" value="" class="inited">
											</td>
											<td class="stat-operations-td">
												<button type="button" class="btn btn-xs" aria-label="Применить" name="apply" onclick="apply_filter('scroller_organizationlist_266570221142355520');"><span class="glyphicon glyphicon-filter" aria-hidden="true"></span></button>
												<button type="button" class="btn btn-xs" aria-label="Очистить" name="clear" onclick="clear_filter('scroller_organizationlist_266570221142355520');"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
											</td>
										
									</tr>-->
									<tr class="odd gradeX ">
										<td name="region" id="region">г. Москва</td>
										<td name="2" id="2">Ремонт дороги по адресу г. Москва, ул. Тверская-Ямская, д. 3</td>
										<td name="name" id="name">Муниципалитет 1</td>
										<td name="amount" id="amount">22 364-30</td>
										<td name="contacts" id="contacts">Адрес: 123231, г. Москва, ул. Добрянская, д. 12, телефон: 8(495)345-34-54</td>
										<td>
											<button type="button" class="btn btn-xs" aria-label="Задать вопрос" name="edit" onclick="row_request('scroller_organizationlist_266570221142355520', '2');"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>
										</td>
									</tr>
									<tr class="odd gradeX ">
										<td name="region" id="region">г. Москва</td>
										<td name="2" id="2">Ремонт дороги по адресу г. Москва, ул. Новый Арбат, д. 1</td>
										<td name="name" id="name">Муниципалитет 1</td>
										<td name="amount" id="amount">123 364-10</td>
										<td name="contacts" id="contacts">Адрес: 123231, г. Москва, ул. Добрянская, д. 12, телефон: 8(495)345-34-54</td>
										<td>
											<button type="button" class="btn btn-xs" aria-label="Задать вопрос" name="edit" onclick="row_request('scroller_organizationlist_266570221142355520', '2');"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>
										</td>
									</tr>
									<tr class="odd gradeX ">
										<td name="region" id="region">Волгоградская область</td>
										<td name="2" id="2">Ремонт дороги по адресу г. Москва, ул. Тверская-Ямская, д. 3</td>
										<td name="name" id="name">Муниципалитет 2</td>
										<td name="amount" id="amount">765 622 364-00</td>
										<td name="contacts" id="contacts">Адрес: 645654, г. Волгоград, ул. Киселевская, д. 14, телефон: 8(4534)234-78-56</td>
										<td>
											<button type="button" class="btn btn-xs" aria-label="Задать вопрос" name="edit" onclick="row_request('scroller_organizationlist_266570221142355520', '2');"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button>
										</td>
									</tr>
								</tbody>
							</table>
							<div class="panel-footer">
								<!-- записей на странице -->
								<span class="pull-right">Показывать по&nbsp;
									<select name="page_sizes" onchange="change_page_size('scroller_organizationlist_266570221142355520');">
										<option value="30">30</option>
										<option value="50">50</option>
										<option value="100" selected="selected">100</option>
									</select>
								</span>
								<nav>
										<ul class="pagination stat-pager">
											<li class="disabled"><span aria-label="Previous"><span aria-hidden="true">«</span></span></li>
											<!-- выводим номера страниц -->
											<li class="active"><span><span aria-hidden="true">1</span></span></li>
											<li><a href="#" onclick="change_page('scroller_organizationlist_266570221142355520', 2);">2</a></li>
											<li><a href="#" onclick="change_page('scroller_organizationlist_266570221142355520', 3);">3</a></li>
											<li><a href="#" onclick="change_page('scroller_organizationlist_266570221142355520', 4);">4</a></li>
											<li onclick="change_page('scroller_organizationlist_266570221142355520', 1+1);"><a href="#" aria-label="pager_next"><span aria-hidden="true">»</span></a></li>
										</ul>
									</nav>
							</div>
						<!-- /.panel-body -->
					</div>
				</div>
			</div>
		</div>
		<footer>
			footer
		</footer>
		
		<!-- Модальные окна -->
		<div class="modal fade" id="logonModal" tabindex="-1" role="dialog" aria-labelledby="logonModalHeader">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="logonModalHeader">Добро пожаловать</h4>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-lg-1"></div>
							<div class="col-lg-offset-1 col-lg-10 center-block">
								<form class="form-signin">
									<h2 class="form-signin-heading text-center">Авторизация</h2>
									<div class="input-group">
										<span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
										<input type="email" id="email" class="form-control" placeholder="Email" autofocus="">
									</div>
									<div class="row"><div class="col-lg-12 text-center">ИЛИ</div></div>
									<div class="input-group">
											<span class="input-group-addon"><i class="glyphicon glyphicon-phone-alt"></i></span>
											<input id="phone" type="tel" class="form-control" name="phone" value="" placeholder="Телефон" pattern="[0-9]+" maxlength="12">                                        
									</div>
									<div class="row"><div class="col-lg-12 text-center">&nbsp;</div></div>
									<div class="input-group">
										<span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
										<input id="password" type="password" class="form-control" name="password" value="" required="" placeholder="Пароль">                                        
									</div>
									<div class="checkbox">
										<label>
											<input type="checkbox" value="remember-me"> Запомнить меня
										</label>
									</div>
									<!--<button class="btn btn-lg btn-primary btn-block" type="submit" formmethod="get" formaction="/session/start">Войти</button>-->
									<button class="btn btn-lg btn-primary btn-block" onclick="login();">Войти</button>
								</form>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<!--<button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>-->
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal-dialog -->
		</div>
		<div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="registerModalHeader">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="registerModalHeader">Добро пожаловать</h4>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-lg-1"></div>
							<div class="col-lg-offset-1 col-lg-10 center-block">
								<!-- wizard: http://vadimg.com/twitter-bootstrap-wizard-example/#examples -->
								<form class="form-signin">
									<h2 class="form-signin-heading text-center">Регистрация</h2>
									<div class="input-group">
										<span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
										<input type="email" id="email" class="form-control" placeholder="Email" autofocus="">
									</div>
									<div class="row"><div class="col-lg-12 text-center">И/ИЛИ</div></div>
									<div class="input-group">
											<span class="input-group-addon"><i class="glyphicon glyphicon-phone-alt"></i></span>
											<input id="phone" type="tel" class="form-control" name="phone" value="" placeholder="Телефон" pattern="[0-9]+" maxlength="12">                                        
									</div>
									<div class="row"><div class="col-lg-12 text-center">&nbsp;</div></div>
									<div class="input-group">
										<span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
										<input id="password" type="password" class="form-control" name="password" value="" required="" placeholder="Пароль">                                        
									</div>
									<div class="row"><div class="col-lg-12 text-center">&nbsp;</div></div>
									<div class="input-group">
										<span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
										<input id="password2" type="password" class="form-control" name="password2" value="" required="" placeholder="Повторите пароль">                                        
									</div>
									<div class="row"><div class="col-lg-12 text-center">&nbsp;</div></div>
									<!--<button class="btn btn-lg btn-primary btn-block" type="submit" formmethod="get" formaction="/session/start">Войти</button>-->
									<button class="btn btn-lg btn-primary btn-block" onclick="register();">Зарегистрироваться</button>
								</form>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<!--<button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>-->
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal-dialog -->
		</div>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<script src="../public/bootstrap-3.3.6-dist/js/bootstrap.min.js"></script>
		<script src="../public/jsrender.js"></script>
		<!--<script src="../public/sha1.js"></script>-->
		<!-- https://www.npmjs.com/package/js-sha1 -->
		<script src="../public/js-sha1-0.3.0.js"></script>
		
		<script type="text/javascript"><!--
			function login() {
				var url = '/session/start';
				var modal = $("#logonModal");
				
				var phone = modal.find('#phone').val();
				if (phone) url += '&phone=' + encodeURIComponent(phone);
				var email = modal.find('#email').val();
				if (email) url += '&email=' + encodeURIComponent(email);
				var password = modal.find('#password').val();
				password = sha1(password);
				if (password) url += '&password=' + encodeURIComponent(password);
				
				console.log(url);
				
				$.ajax({
					url: url,
					dataType: 'json',
					method: 'post',
					beforeSend: function() {
							// показываем прогрессбар
					},
					complete: function() {
						// скрываем прогрессбар
					},			
					success: function(json) {
						if(json.ok){
							if(json.redirect) document.location = json.redirect;
							else document.location.reload();
						}
						else {
							console.log("Login failed");
						}
					},
					error: function(xhr, ajaxOptions, thrownError) {
						//console.log(thrownError + "\r\n" + (xhr != null ? xhr.statusText + "\r\n" + xhr.responseText + "\r\n" : ""));
						console.log(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
						//console.log(thrownError);
						//alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
					}
				});
			}
			
			function register() {
			}
		//--></script>
		
		<script type="text/javascript">
			var descriptor = {
				columns: [
					{type: 'string', value: 'Наименование расхода'},
					{type: 'string', value: 'Муниципалитет'},
					{type: 'number', value: 'Сумма, р.'},
					{type: 'number', value: 'Идентификатор'}
				],
				items: [
					['Ремонт дороги по адресу г. Москва, ул. Тверская-Ямская, д. 3', 450, 2],
					['Ремонт дороги по адресу г. Москва, ул. Новый Арбат, д. 1', 347, 123, 14],
					['Ремонт дороги по адресу г. Москва, ул. Тверская-Ямская, д. 3', 215, 332, 5]
				]
			}
			
			function row_request(container_id, id) {
				var url = 'C:\\wamp64/www/stat.admin/client/request.html';
				document.location = url;
			}
	  </script>
	</body>
</html>